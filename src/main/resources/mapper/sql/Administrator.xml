<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- 관리자 로그인  -->
<mapper namespace="administratorSql">

	<!-- 관리자 목록 모두 가져오기 -->	
	<select id="selectAll"  resultType="AdministratorInfo">
		SELECT   AdminNo 	AS intAdminNo
				,AdminId 	AS strAdminId
		    	,AdminPw	AS strAdminPw
		    	,AdminName	AS strAdminName
		    	,AuthNo		AS intAdminAuth
		    	,AdminDate	AS dateAdminDate
		FROM 	TAdmin
	</select>	
	
	<!-- 아이디 중복체크 -->	
	<select id="selectId"  resultType="AdministratorInfo">
		select   AdminId 	AS strAdminId	
		from TAdmin where AdminId = #{id} 
	</select>

	<!-- 관리자 등록 -->	
	<insert id="insertAdmin" >
		insert into TAdmin(AdminId,AdminPw,AdminName, AuthNo) values(
			#{StrAdminId}, #{StrAdminPw}, #{StrAdminName}, #{intAdminAuth}
			)
	</insert>
	
	
	<!-- 관리자 정보 가져오기 -->	
	<select id="selectAdmin"  resultType="AdministratorInfo">
		SELECT   AdminNo 	AS intAdminNo
				,AdminId 	AS strAdminId
		    	,AdminPw	AS strAdminPw
		    	,AdminName	AS strAdminName
		    	,AuthNo		AS intAdminAuth
		    	,AdminDate	AS dateAdminDate
		FROM 	TAdmin
		where AdminNo	=	#{intAdminNo}
	</select>	
	
	
	<!-- 권한번호로 맨 상위 권한 항목 가져오기 -->	
	<select id="selectItemNo" resultType="int">
		select top 1 AuthItemNo
		from TAuthMapp
		where AuthNo = #{authNo}	
	</select>
	
	<!-- 수정할 관리자의 번호로 권한 번호 찾기 -->
	<select id="selectAuthNo" resultType="int">
		SELECT   AuthNo		AS intAdminAuth
		FROM 	TAdmin
		where AdminNo	=	#{adminNo}
	
	</select>
	
	<!-- 수정할 권한번호로 권한항목 개수 가져오기 -->	
	<select id="selectItemCount" resultType="int">
		select  count(AuthItemNo)
		from	TAuthMapp
		where AuthNo = #{authNo}
	</select>
	
	<!-- 관리자 정보 업데이트 -->
	<update id="updateAdmin">
		update	TAdmin
		set		AdminPw		= #{StrAdminPw}
				,AdminName	= #{StrAdminName}
				,AuthNo		= #{intAdminAuth}
		where	AdminId = #{StrAdminId}
	
	</update>

</mapper>

